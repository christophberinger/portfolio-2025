---
import Layout from "../layouts/Layout.astro";
import Footer from "../components/Footer.astro";
import FadeIn from "../components/FadeIn.astro";
---

<Layout title="WebPeasy - WordPress WebP Optimization Plugin">
  <style is:global>
    body {
      background-color: rgb(193, 255, 209) !important;
    }
  </style>
  <div class="webpeasy-page">
    <FadeIn>
      <h1>WebPeasy</h1>
      <p class="subtitle">WordPress WebP Optimization Plugin</p>
    </FadeIn>

    <FadeIn delay={0.1}>
      <section class="intro">
        <p class="lead">
          Automatically deliver frontend images as WebP with PHP-based URL rewriting,
          while leaving the Media Library and original files untouched.
        </p>
        <div class="download-section">
          <a
            href="https://github.com/christophberinger/WebPeasy"
            target="_blank"
            rel="noopener noreferrer"
            class="download-button"
          >
            <svg width="24" height="24" viewBox="0 0 16 16" fill="currentColor">
              <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
            </svg>
            Get Plugin on GitHub
          </a>
          <p class="free-label">Free & Open Source</p>
        </div>
      </section>
    </FadeIn>

    <FadeIn delay={0.2}>
      <section class="description">
        <h2>Description</h2>
        <p>
          WebPeasy is a production-ready WordPress solution that automatically converts
          all frontend images to WebP format while leaving your Media Library and original
          files completely untouched.
        </p>
      </section>
    </FadeIn>

    <FadeIn delay={0.3}>
      <section class="features">
        <h2>Key Features</h2>
        <ul>
          <li><strong>Non-Destructive:</strong> Original files remain unchanged in your Media Library</li>
          <li><strong>Automatic Conversion:</strong> All generated image sizes (thumbnails, medium, large, custom) are created as WebP</li>
          <li><strong>Built-in Regeneration:</strong> Bulk regenerate all existing images with real-time progress tracking</li>
          <li><strong>Smart URL Rewriting:</strong> PHP-based output buffering automatically serves WebP versions</li>
          <li><strong>Universal Compatibility:</strong> Works on any server (Apache, Nginx, LiteSpeed) - no .htaccess needed</li>
          <li><strong>Browser Detection:</strong> Automatically serves WebP only to browsers that support it</li>
          <li><strong>Global Quality Control:</strong> Single slider to configure WebP compression quality (0-100)</li>
          <li><strong>Smart Detection:</strong> Automatically detects WebP support in your PHP environment</li>
          <li><strong>Graceful Fallback:</strong> Works seamlessly on servers without WebP support</li>
        </ul>
      </section>
    </FadeIn>

    <FadeIn delay={0.4}>
      <section class="how-it-works">
        <h2>How It Works</h2>
        <p>
          The plugin uses WordPress's built-in <code>image_editor_output_format</code> filter
          to convert newly uploaded images to WebP format. For existing images, it uses PHP
          output buffering to automatically replace image URLs with WebP versions when:
        </p>
        <ol>
          <li>The browser supports WebP (detected via HTTP Accept header)</li>
          <li>A WebP version of the image exists on the server</li>
          <li>The request is for a frontend page (not admin/AJAX/cron)</li>
        </ol>
        <p>
          Original JPG/PNG files are preserved alongside WebP versions, providing automatic
          fallback for older browsers.
        </p>
      </section>
    </FadeIn>

    <FadeIn delay={0.5}>
      <section class="regeneration">
        <h2>Built-in Thumbnail Regeneration</h2>
        <p>
          Navigate to Settings → WebPeasy and use the built-in regeneration tool to convert
          all existing images:
        </p>
        <ul>
          <li>Real-time progress tracking</li>
          <li>Batch processing (5 images at a time)</li>
          <li>No timeout issues</li>
          <li>Cancel anytime</li>
          <li>Preserves original files</li>
        </ul>
      </section>
    </FadeIn>

    <FadeIn delay={0.6}>
      <section class="requirements">
        <h2>Requirements</h2>
        <ul>
          <li>WordPress 5.0 or higher</li>
          <li>PHP 7.0 or higher</li>
          <li>ImageMagick or GD with WebP support</li>
        </ul>
      </section>
    </FadeIn>

    <FadeIn delay={0.7}>
      <section class="installation">
        <h2>Installation</h2>
        <ol>
          <li>Upload the <code>webpeasy</code> folder to <code>/wp-content/plugins/</code></li>
          <li>Activate the plugin through the 'Plugins' menu in WordPress</li>
          <li>Go to Settings → WebPeasy to configure</li>
          <li>(Optional) Click "Regenerate Thumbnails" to convert existing images</li>
        </ol>
      </section>
    </FadeIn>

    <FadeIn delay={0.8}>
      <section class="faq">
        <h2>Frequently Asked Questions</h2>

        <div class="faq-item">
          <h3>Will this slow down my site?</h3>
          <p>
            No. Conversion happens during upload, not on page load. The PHP URL rewriting
            adds minimal overhead (~10-20ms) but the smaller WebP files load much faster,
            resulting in net performance gains.
          </p>
        </div>

        <div class="faq-item">
          <h3>Does it work on Nginx/LiteSpeed?</h3>
          <p>
            Yes! Unlike .htaccess-based solutions, this plugin works on any server because
            it uses PHP output buffering.
          </p>
        </div>

        <div class="faq-item">
          <h3>Do I need to delete my old images?</h3>
          <p>
            No. Original JPG/PNG files are preserved alongside WebP versions. This provides
            automatic fallback for older browsers.
          </p>
        </div>

        <div class="faq-item">
          <h3>What if my host doesn't support WebP?</h3>
          <p>
            The plugin will detect this and gracefully do nothing. No errors, no broken images.
          </p>
        </div>

        <div class="faq-item">
          <h3>Will this work with caching plugins?</h3>
          <p>
            Yes. The rewriting happens before page caching, so cached pages will already have
            WebP URLs. Make sure to clear your cache after regenerating images.
          </p>
        </div>

        <div class="faq-item">
          <h3>Can I revert to JPEG/PNG?</h3>
          <p>
            Yes. Simply deactivate the plugin. Original files were never changed, so your site
            will work immediately with the original images.
          </p>
        </div>
      </section>
    </FadeIn>

    <FadeIn delay={0.9}>
      <section class="meta">
        <h2>Plugin Information</h2>
        <dl>
          <dt>Version:</dt>
          <dd>1.0.0</dd>

          <dt>Author:</dt>
          <dd>Christoph Beringer</dd>

          <dt>License:</dt>
          <dd>GPLv2 or later</dd>

          <dt>Tags:</dt>
          <dd>webp, images, performance, optimization, compression</dd>
        </dl>
      </section>
    </FadeIn>

    <Footer />
  </div>

  <style>
    .webpeasy-page {
      max-width: 900px;
      margin: 0 auto;
      padding: 2rem 1rem;
      background-color: rgb(193, 255, 209);
      color: #212427;
      min-height: 100vh;
    }

    h1 {
      font-size: 3rem;
      margin-bottom: 0.5rem;
      font-weight: 700;
    }

    .subtitle {
      font-size: 1.25rem;
      color: var(--color-text-muted, #666);
      margin-bottom: 3rem;
    }

    .lead {
      font-size: 1.25rem;
      line-height: 1.6;
      margin-bottom: 2rem;
    }

    .download-section {
      margin-top: 2rem;
      text-align: center;
    }

    .download-button {
      display: inline-flex;
      align-items: center;
      gap: 0.75rem;
      padding: 1rem 2rem;
      font-size: 1.125rem;
      font-weight: 600;
      color: white;
      background-color: #24292e;
      border-radius: 8px;
      text-decoration: none;
      transition: all 0.2s ease;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .download-button:hover {
      background-color: #1a1e22;
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
    }

    .download-button svg {
      width: 24px;
      height: 24px;
    }

    .free-label {
      margin-top: 1rem;
      font-size: 0.9rem;
      color: var(--color-text-muted, #666);
      font-weight: 500;
    }

    section {
      margin-bottom: 3rem;
    }

    h2 {
      font-size: 2rem;
      margin-bottom: 1.5rem;
      margin-top: 3rem;
      font-weight: 600;
    }

    h3 {
      font-size: 1.25rem;
      margin-bottom: 0.75rem;
      font-weight: 600;
    }

    p {
      margin-bottom: 1rem;
      line-height: 1.7;
    }

    ul, ol {
      margin-bottom: 1.5rem;
      padding-left: 1.5rem;
    }

    li {
      margin-bottom: 0.75rem;
      line-height: 1.6;
    }

    .faq-item {
      margin-bottom: 2rem;
      padding-bottom: 2rem;
      border-bottom: 1px solid var(--color-border, #e5e5e5);
    }

    .faq-item:last-child {
      border-bottom: none;
    }

    code {
      background-color: var(--color-code-bg, #f5f5f5);
      padding: 0.2rem 0.4rem;
      border-radius: 3px;
      font-family: 'Courier New', monospace;
      font-size: 0.9em;
    }

    dl {
      display: grid;
      grid-template-columns: auto 1fr;
      gap: 0.75rem 1.5rem;
    }

    dt {
      font-weight: 600;
    }

    dd {
      margin: 0;
    }

    @media (max-width: 768px) {
      h1 {
        font-size: 2rem;
      }

      h2 {
        font-size: 1.5rem;
      }

      .lead {
        font-size: 1.1rem;
      }
    }
  </style>
</Layout>
